<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Healthy Eats Planner</title>
   <link rel="icon" type="image/x-icon" href="favicon.ico">
   <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
   <script src="https://cdn.tailwindcss.com"></script>
   <style>
       body { font-family: Arial, sans-serif; }
       .btn {
           padding: 12px 16px;
           border-radius: 8px;
           font-weight: 600;
           font-size: 1rem;
           line-height: 1.5;
           min-height: 48px;
           transition: all 0.2s ease;
       }
       .day-btn {
           flex: 1;
           margin-right: 4px;
           background: linear-gradient(to bottom, #1d4ed8, #1e40af);
           color: white;
       }
       .day-btn:last-child { margin-right: 0; }
       .meal-btn {
           flex: 1;
           margin-right: 4px;
           background: linear-gradient(to bottom, #15803d, #14532d);
           color: white;
       }
       .meal-btn:last-child { margin-right: 0; }
       .day-btn:hover, .meal-btn:hover { transform: translateY(-2px); }
       .selected-day {
           background: linear-gradient(to bottom, #93c5fd, #60a5fa);
           transform: translateY(-2px);
           color: black;
       }
       .selected-meal {
           background: linear-gradient(to bottom, #86efac, #4ade80);
           transform: translateY(-2px);
           color: black;
       }
       .rating-btn {
           padding: 12px 16px;
           border-radius: 8px;
           font-weight: 600;
           color: white;
           font-size: 0.875rem;
           background: linear-gradient(to bottom, #0f766e, #064e3b);
           cursor: pointer;
           position: relative;
           min-width: 100px;
           max-width: 120px;
           line-height: 1.5;
           min-height: 48px;
           display: inline-block;
           margin: 4px;
           text-align: center;
       }
       .rating-btn:hover { transform: translateY(-2px); }
       .rating-options {
           position: absolute;
           background-color: #f3f4f6;
           border-radius: 8px;
           box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
           z-index: 10;
           top: 100%;
           left: 0;
           right: 0;
           display: none;
       }
       .rating-options div {
           padding: 8px 16px;
           color: black;
       }
       .rating-options div:hover {
           background-color: #e5e7eb;
           cursor: pointer;
       }
       .rating-btn.open .rating-options { display: block; }
       #day-buttons {
           display: flex;
           width: 100%;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 10px;
       }
       #meal-buttons {
           display: flex;
           width: 100%;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 16px;
       }
       #ratings {
           width: 100%;
           text-align: center;
           margin-top: 16px;
           margin-bottom: 16px;
       }
       #toggle-meal-info {
           padding: 12px;
           border-radius: 8px;
           font-size: 0.875rem;
           font-weight: bold;
           cursor: pointer;
           background: linear-gradient(to bottom, #0f766e, #064e3b);
           color: white;
           line-height: 1.5;
           min-height: 48px;
           width: 48px;
           text-align: center;
           display: inline-block;
           margin: 4px;
       }
       #toggle-meal-info:hover { background: #064e3b; }
       #toggle-plan-info {
           padding: 12px;
           border-radius: 8px;
           font-size: 0.875rem;
           font-weight: bold;
           cursor: pointer;
           background: linear-gradient(to bottom, #15803d, #14532d);
           color: white;
           line-height: 1.5;
           min-height: 48px;
           width: 48px;
           text-align: center;
           display: inline-block;
           margin: 4px;
       }
       #toggle-plan-info:hover { background: #14532d; }
       .price, .nutrition { display: none; }
       #notes {
           width: 100%;
           margin-top: 16px;
           margin-bottom: 16px;
       }
       #notes textarea {
           width: 100%;
           padding: 8px;
           border-radius: 8px;
           border: 1px solid #d1d5db;
           resize: vertical;
           font-size: 1rem;
       }
       #recipe-container {
           margin: 0 auto;
           width: 95%;
           max-width: 600px;
       }
       #plan-info {
           margin: 0 auto;
           width: 95%;
           max-width: 600px;
           background-color: #f3f4f6;
           border-radius: 8px;
           padding: 16px;
           display: none;
       }
       @media (min-width: 768px) {
           #recipe-container, #plan-info { width: 50%; }
       }
       .grayed-out { opacity: 0.5; }
   </style>
</head>
<body class="bg-gray-200 p-4">
   <h1 class="text-2xl font-bold text-center mb-4">Healthy Eats Planner</h1>
   <div class="text-center">
       <div id="day-buttons" class="flex space-x-1">
           <button class="btn day-btn" onclick="selectDay('Monday')">Mon</button>
           <button class="btn day-btn" onclick="selectDay('Tuesday')">Tue</button>
           <button class="btn day-btn" onclick="selectDay('Wednesday')">Wed</button>
           <button class="btn day-btn" onclick="selectDay('Thursday')">Thu</button>
           <button class="btn day-btn" onclick="selectDay('Friday')">Fri</button>
           <button class="btn day-btn" onclick="selectDay('Saturday')">Sat</button>
           <button class="btn day-btn" onclick="selectDay('Sunday')">Sun</button>
       </div>
   </div>
   <div class="text-center">
       <div id="meal-buttons" class="flex space-x-1 mt-2 mb-4">
           <button class="btn meal-btn" onclick="selectMeal('Breakfast')">Breakfast</button>
           <button class="btn meal-btn" onclick="selectMeal('Lunch')">Lunch</button>
           <button class="btn meal-btn" onclick="selectMeal('Dinner')">Dinner</button>
           <button class="btn meal-btn" onclick="selectMeal('Dessert')">Dessert</button>
           <button id="toggle-plan-info" class="btn meal-btn" onclick="togglePlanInfo()">ℹ️</button>
       </div>
   </div>
   <div id="plan-info">
       <h1 class="text-2xl font-bold text-center mb-4">Statistics</h1>
       <div class="mb-4 flex justify-center space-x-4">
           <label class="flex items-center">
               <input type="checkbox" id="include-snacks" checked class="mr-2">
               Include 1 Snack Per Day
           </label>
           <label class="flex items-center">
               <input type="checkbox" id="include-desserts" checked class="mr-2">
               Include 1 Dessert Per Day
           </label>
       </div>
       <h2 class="text-xl font-bold mb-4 text-center">Average Costs</h2>
       <table class="w-full border-collapse border border-gray-300 text-lg">
           <thead>
               <tr class="bg-gray-200">
                   <th class="border border-gray-300 p-2"></th>
                   <th class="border border-gray-300 p-2">Day</th>
                   <th class="border border-gray-300 p-2">Week</th>
                   <th class="border border-gray-300 p-2">Month</th>
                   <th class="border border-gray-300 p-2">Year</th>
               </tr>
           </thead>
           <tbody id="cost-table-body">
               <tr><td class="border border-gray-300 p-2 font-bold">Breakfasts</td><td class="border border-gray-300 p-2 text-center">$1.03</td><td class="border border-gray-300 p-2 text-center">$7.21</td><td class="border border-gray-300 p-2 text-center">$31.33</td><td class="border border-gray-300 p-2 text-center">$375.95</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Lunches</td><td class="border border-gray-300 p-2 text-center">$1.61</td><td class="border border-gray-300 p-2 text-center">$11.27</td><td class="border border-gray-300 p-2 text-center">$48.98</td><td class="border border-gray-300 p-2 text-center">$587.65</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Dinners</td><td class="border border-gray-300 p-2 text-center">$2.12</td><td class="border border-gray-300 p-2 text-center">$14.84</td><td class="border border-gray-300 p-2 text-center">$64.49</td><td class="border border-gray-300 p-2 text-center">$773.80</td></tr>
               <tr id="snacks-row"><td class="border border-gray-300 p-2 font-bold">Snacks</td><td class="border border-gray-300 p-2 text-center">$1.02</td><td class="border border-gray-300 p-2 text-center">$7.14</td><td class="border border-gray-300 p-2 text-center">$31.03</td><td class="border border-gray-300 p-2 text-center">$372.30</td></tr>
               <tr id="desserts-row"><td class="border border-gray-300 p-2 font-bold">Desserts</td><td class="border border-gray-300 p-2 text-center">$1.16</td><td class="border border-gray-300 p-2 text-center">$8.12</td><td class="border border-gray-300 p-2 text-center">$35.29</td><td class="border border-gray-300 p-2 text-center">$423.40</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Total</td><td class="border border-gray-300 p-2 text-center" id="total-day">$6.94</td><td class="border border-gray-300 p-2 text-center" id="total-week">$48.58</td><td class="border border-gray-300 p-2 text-center" id="total-month">$211.12</td><td class="border border-gray-300 p-2 text-center" id="total-year">$2533.10</td></tr>
           </tbody>
       </table>
       <h2 class="text-xl font-bold mt-6 mb-4 text-center">Average Nutrition</h2>
       <table class="w-full border-collapse border border-gray-300 text-lg">
           <thead>
               <tr class="bg-gray-200">
                   <th class="border border-gray-300 p-2"></th>
                   <th class="border border-gray-300 p-2">Day</th>
                   <th class="border border-gray-300 p-2">Week</th>
                   <th class="border border-gray-300 p-2">Month</th>
                   <th class="border border-gray-300 p-2">Year</th>
               </tr>
           </thead>
           <tbody>
               <tr><td class="border border-gray-300 p-2 font-bold">Calories (kcal)</td><td class="border border-gray-300 p-2 text-center" id="calories-day">1620</td><td class="border border-gray-300 p-2 text-center" id="calories-week">11340</td><td class="border border-gray-300 p-2 text-center" id="calories-month">49280</td><td class="border border-gray-300 p-2 text-center" id="calories-year">590900</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Protein (g)</td><td class="border border-gray-300 p-2 text-center" id="protein-day">83</td><td class="border border-gray-300 p-2 text-center" id="protein-week">581</td><td class="border border-gray-300 p-2 text-center" id="protein-month">2525</td><td class="border border-gray-300 p-2 text-center" id="protein-year">30295</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Fiber (g)</td><td class="border border-gray-300 p-2 text-center" id="fiber-day">22</td><td class="border border-gray-300 p-2 text-center" id="fiber-week">154</td><td class="border border-gray-300 p-2 text-center" id="fiber-month">669</td><td class="border border-gray-300 p-2 text-center" id="fiber-year">8030</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Sodium (mg)</td><td class="border border-gray-300 p-2 text-center" id="sodium-day">1400</td><td class="border border-gray-300 p-2 text-center" id="sodium-week">9800</td><td class="border border-gray-300 p-2 text-center" id="sodium-month">42588</td><td class="border border-gray-300 p-2 text-center" id="sodium-year">511000</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Fat (g)</td><td class="border border-gray-300 p-2 text-center" id="fat-day">60</td><td class="border border-gray-300 p-2 text-center" id="fat-week">420</td><td class="border border-gray-300 p-2 text-center" id="fat-month">1825</td><td class="border border-gray-300 p-2 text-center" id="fat-year">21900</td></tr>
               <tr><td class="border border-gray-300 p-2 font-bold">Carbohydrates (g)</td><td class="border border-gray-300 p-2 text-center" id="carbs-day">180</td><td class="border border-gray-300 p-2 text-center" id="carbs-week">1260</td><td class="border border-gray-300 p-2 text-center" id="carbs-month">5476</td><td class="border border-gray-300 p-2 text-center" id="carbs-year">65700</td></tr>
           </tbody>
       </table>
   </div>
   <div id="recipe" class="hidden">
       <div id="recipe-container">
           <h2 id="recipe-title" class="text-2xl font-bold text-center mb-4"></h2>
           <span id="cost" class="text-xl font-bold mb-4 block text-center"><span class="price"></span></span>
           <div id="ingredients" class="text-lg mb-4"></div>
           <p id="prep" class="text-lg mb-4"><strong>Prep:</strong> </p>
           <p id="nutrition" class="text-lg mb-4 nutrition"><strong>Nutrition:</strong> </p>
           <div id="ratings">
               <div class="rating-btn" id="flavor-btn" onclick="toggleRating('flavor')">
                   Flavor: <span id="flavor-value">---</span>
                   <div class="rating-options" id="flavor-options">
                       <div onclick="setRating('flavor', '1')">1</div>
                       <div onclick="setRating('flavor', '2')">2</div>
                       <div onclick="setRating('flavor', '3')">3</div>
                       <div onclick="setRating('flavor', '4')">4</div>
                       <div onclick="setRating('flavor', '5')">5</div>
                       <div onclick="setRating('flavor', '6')">6</div>
                       <div onclick="setRating('flavor', '7')">7</div>
                       <div onclick="setRating('flavor', '8')">8</div>
                       <div onclick="setRating('flavor', '9')">9</div>
                       <div onclick="setRating('flavor', '10')">10</div>
                   </div>
               </div>
               <div class="rating-btn" id="prep-btn" onclick="toggleRating('prep')">
                   Prep: <span id="prep-value">---</span>
                   <div class="rating-options" id="prep-options">
                       <div onclick="setRating('prep', '1')">1</div>
                       <div onclick="setRating('prep', '2')">2</div>
                       <div onclick="setRating('prep', '3')">3</div>
                       <div onclick="setRating('prep', '4')">4</div>
                       <div onclick="setRating('prep', '5')">5</div>
                       <div onclick="setRating('prep', '6')">6</div>
                       <div onclick="setRating('prep', '7')">7</div>
                       <div onclick="setRating('prep', '8')">8</div>
                       <div onclick="setRating('prep', '9')">9</div>
                       <div onclick="setRating('prep', '10')">10</div>
                   </div>
               </div>
               <div class="rating-btn" id="cleanup-btn" onclick="toggleRating('cleanup')">
                   Cleanup: <span id="cleanup-value">---</span>
                   <div class="rating-options" id="cleanup-options">
                       <div onclick="setRating('cleanup', '1')">1</div>
                       <div onclick="setRating('cleanup', '2')">2</div>
                       <div onclick="setRating('cleanup', '3')">3</div>
                       <div onclick="setRating('cleanup', '4')">4</div>
                       <div onclick="setRating('cleanup', '5')">5</div>
                       <div onclick="setRating('cleanup', '6')">6</div>
                       <div onclick="setRating('cleanup', '7')">7</div>
                       <div onclick="setRating('cleanup', '8')">8</div>
                       <div onclick="setRating('cleanup', '9')">9</div>
                       <div onclick="setRating('cleanup', '10')">10</div>
                   </div>
               </div>
               <button id="toggle-meal-info" onclick="toggleMealInfo()">ℹ️</button>
           </div>
           <div id="notes">
               <textarea id="notes-text" rows="4" placeholder="Add your notes about this meal..."></textarea>
           </div>
           <p id="snack" class="text-lg mb-4"></p>
       </div>
   </div>
   <script>
       let menu = null;
       let selectedDay = null;
       let selectedMeal = null;
       let mealInfoVisible = false;
       let planInfoVisible = false;

       fetch('menu.json')
           .then(response => response.json())
           .then(data => {
               menu = data;
               updateRecipe();
               updatePlanInfoTable();
               updateNutritionTable();
           })
           .catch(error => {
               console.error('Error loading menu:', error);
               alert('Failed to load menu data. Please try refreshing the page.');
           });

       function selectDay(day) {
           selectedDay = day;
           document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('selected-day'));
           document.querySelector(`button[onclick="selectDay('${day}')"]`).classList.add('selected-day');
           planInfoVisible = false;
           document.getElementById('plan-info').style.display = 'none';
           document.getElementById('toggle-plan-info').classList.remove('selected-meal');
           updateRecipe();
       }

       function selectMeal(meal) {
           selectedMeal = meal;
           document.querySelectorAll('.meal-btn').forEach(btn => btn.classList.remove('selected-meal'));
           document.querySelector(`button[onclick="selectMeal('${meal}')"]`).classList.add('selected-meal');
           planInfoVisible = false;
           document.getElementById('plan-info').style.display = 'none';
           document.getElementById('toggle-plan-info').classList.remove('selected-meal');
           updateRecipe();
       }

       function toggleRating(type) {
           const btn = document.getElementById(`${type}-btn`);
           btn.classList.toggle('open');
           document.querySelectorAll('.rating-btn').forEach(el => {
               if (el !== btn) el.classList.remove('open');
           });
       }

       function setRating(type, value) {
           const valueSpan = document.getElementById(`${type}-value`);
           valueSpan.textContent = value;
           const btn = document.getElementById(`${type}-btn`);
           if (btn) btn.classList.remove('open');
           document.querySelectorAll('.rating-btn').forEach(el => el.classList.remove('open'));
           const key = `${selectedDay}-${selectedMeal}-${type}`.toLowerCase();
           localStorage.setItem(key, value);
           setTimeout(() => document.querySelectorAll('.rating-btn').forEach(el => el.classList.remove('open')), 0);
       }

       function updateRecipe() {
           if (selectedDay && selectedMeal && menu) {
               const recipe = menu[selectedDay][selectedMeal];
               document.getElementById('recipe').style.display = 'block';
               document.getElementById('recipe-title').textContent = recipe.title;
               document.getElementById('cost').innerHTML = `<span class="price">#${recipe.number} ${recipe.cost}</span>`;
               const ingredientsList = document.getElementById('ingredients');
               ingredientsList.innerHTML = '<strong>Ingredients:</strong><ul>' +
                   recipe.ingredients.map(ing => `<li>${ing.name} <span class="price"> - ${ing.cost}</span></li>`).join('') + '</ul>';
               const prepElement = document.getElementById('prep');
               prepElement.innerHTML = `<strong>Prep:</strong> ${recipe.prep}`;
               prepElement.style.display = 'block';
               const nutritionElement = document.getElementById('nutrition');
               nutritionElement.innerHTML = `<strong>Nutrition:</strong> ${recipe.nutrition}`;
               nutritionElement.style.display = mealInfoVisible ? 'block' : 'none';
               if (recipe.snack && selectedMeal !== 'Dessert') {
                   const snackElement = document.getElementById('snack');
                   snackElement.innerHTML = `
                       <strong>Post-Meal Snack:</strong> ${recipe.snack.title}<br>
                       <span class="price">#${recipe.snack.number} ${recipe.snack.cost}</span><br>
                       <strong>Ingredients:</strong><ul class="mb-4">${recipe.snack.ingredients.map(ing => `<li>${ing.name} <span class="price"> - ${ing.cost}</span></li>`).join('')}</ul>
                       <strong class="mb-4">Prep:</strong> ${recipe.snack.prep}<br>
                       <p class="nutrition"><strong>Nutrition:</strong> ${recipe.snack.nutrition}</p>`;
                   snackElement.style.display = 'block';
                   snackElement.querySelector('.nutrition').style.display = mealInfoVisible ? 'block' : 'none';
               } else {
                   document.getElementById('snack').style.display = 'none';
               }
               const ratings = ['flavor', 'prep', 'cleanup'];
               ratings.forEach(type => {
                   const valueSpan = document.getElementById(`${type}-value`);
                   const key = `${selectedDay}-${selectedMeal}-${type}`.toLowerCase();
                   const savedRating = localStorage.getItem(key);
                   valueSpan.textContent = savedRating || '---';
               });
               const notesText = document.getElementById('notes-text');
               const notesKey = `${selectedDay}-${selectedMeal}-notes`.toLowerCase();
               notesText.value = localStorage.getItem(notesKey) || '';
               notesText.oninput = () => localStorage.setItem(notesKey, notesText.value);
               document.querySelectorAll('.price').forEach(el => el.style.display = mealInfoVisible ? 'inline' : 'none');
           } else {
               document.getElementById('recipe').style.display = 'none';
           }
       }

       function toggleMealInfo() {
           mealInfoVisible = !mealInfoVisible;
           document.querySelectorAll('.price, .nutrition').forEach(el => el.style.display = mealInfoVisible ? 'inline' : 'none');
           updateRecipe();
       }

       function updatePlanInfoTable() {
           const includeSnacks = document.getElementById('include-snacks').checked;
           const includeDesserts = document.getElementById('include-desserts').checked;
           localStorage.setItem('includeSnacks', includeSnacks);
           localStorage.setItem('includeDesserts', includeDesserts);
           const costs = { breakfast: 1.03, lunch: 1.61, dinner: 2.12, snack: 1.02, dessert: 1.16 };
           let totalDay = costs.breakfast + costs.lunch + costs.dinner;
           if (includeSnacks) totalDay += costs.snack;
           if (includeDesserts) totalDay += costs.dessert;
           const periods = [
               { id: 'day', factor: 1, value: totalDay },
               { id: 'week', factor: 7, value: totalDay * 7 },
               { id: 'month', factor: 30.42, value: totalDay * 30.42 },
               { id: 'year', factor: 365, value: totalDay * 365 }
           ];
           periods.forEach(period => document.getElementById(`total-${period.id}`).textContent = `$${period.value.toFixed(2)}`);
           const snacksRow = document.getElementById('snacks-row');
           const dessertsRow = document.getElementById('desserts-row');
           snacksRow.classList.toggle('grayed-out', !includeSnacks);
           dessertsRow.classList.toggle('grayed-out', !includeDesserts);
       }

       function updateNutritionTable() {
           const includeSnacks = document.getElementById('include-snacks').checked;
           const includeDesserts = document.getElementById('include-desserts').checked;
           const baseNutrition = {
               calories: 1230, protein: 68, fiber: 16, sodium: 1250, fat: 45, carbs: 140
           };
           const snackNutrition = { calories: 200, protein: 8, fiber: 3, sodium: 100, fat: 8, carbs: 20 };
           const dessertNutrition = { calories: 190, protein: 7, fiber: 3, sodium: 50, fat: 7, carbs: 20 };
           let nutrition = { ...baseNutrition };
           if (includeSnacks) {
               nutrition.calories += snackNutrition.calories;
               nutrition.protein += snackNutrition.protein;
               nutrition.fiber += snackNutrition.fiber;
               nutrition.sodium += snackNutrition.sodium;
               nutrition.fat += snackNutrition.fat;
               nutrition.carbs += snackNutrition.carbs;
           }
           if (includeDesserts) {
               nutrition.calories += dessertNutrition.calories;
               nutrition.protein += dessertNutrition.protein;
               nutrition.fiber += dessertNutrition.fiber;
               nutrition.sodium += dessertNutrition.sodium;
               nutrition.fat += dessertNutrition.fat;
               nutrition.carbs += dessertNutrition.carbs;
           }
           const periods = [
               { id: 'day', factor: 1 },
               { id: 'week', factor: 7 },
               { id: 'month', factor: 30.42 },
               { id: 'year', factor: 365 }
           ];
           const metrics = ['calories', 'protein', 'fiber', 'sodium', 'fat', 'carbs'];
           metrics.forEach(metric => {
               periods.forEach(period => {
                   const value = Math.round(nutrition[metric] * period.factor);
                   document.getElementById(`${metric}-${period.id}`).textContent = value;
               });
           });
       }

       function togglePlanInfo() {
           planInfoVisible = !planInfoVisible;
           document.getElementById('plan-info').style.display = planInfoVisible ? 'block' : 'none';
           document.getElementById('toggle-plan-info').classList.toggle('selected-meal', planInfoVisible);
           if (planInfoVisible) {
               selectedDay = null;
               selectedMeal = null;
               document.getElementById('recipe').style.display = 'none';
               document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('selected-day'));
               document.querySelectorAll('.meal-btn').forEach(btn => {
                   if (btn.id !== 'toggle-plan-info') btn.classList.remove('selected-meal');
               });
               updatePlanInfoTable();
               updateNutritionTable();
           }
           updateRecipe();
       }

       document.addEventListener('DOMContentLoaded', () => {
           const includeSnacks = localStorage.getItem('includeSnacks') !== 'false';
           const includeDesserts = localStorage.getItem('includeDesserts') !== 'false';
           document.getElementById('include-snacks').checked = includeSnacks;
           document.getElementById('include-desserts').checked = includeDesserts;
           document.getElementById('include-snacks').addEventListener('change', () => {
               updatePlanInfoTable();
               updateNutritionTable();
           });
           document.getElementById('include-desserts').addEventListener('change', () => {
               updatePlanInfoTable();
               updateNutritionTable();
           });
           updatePlanInfoTable();
           updateNutritionTable();
       });

       document.addEventListener('click', (e) => {
           if (!e.target.closest('.rating-btn')) {
               document.querySelectorAll('.rating-btn').forEach(btn => btn.classList.remove('open'));
           }
       });
   </script>
</body>
</html>